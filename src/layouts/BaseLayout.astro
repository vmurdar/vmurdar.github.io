---
import "../styles/global.css";
import NavLink from "../components/NavLink.astro";

interface NavItem {
  label: string;
  href: string;
}

const { title, navItems = [] } = Astro.props as {
  title: string;
  navItems: NavItem[];
};
---

<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
  </head>

  <body class="bg-zinc-950 text-zinc-100">
    <div class="flex min-h-screen">

      <!-- Sidebar -->
      <aside
        id="sidebar"
        class="fixed inset-y-0 left-0 z-40 w-64 bg-zinc-900 border-r border-zinc-800
               transform -translate-x-full md:translate-x-0
               transition-transform duration-200 ease-in-out"
      >
        <div class="p-6">
          <h2 class="text-lg font-semibold mb-6">Knowledge Base</h2>
          <nav class="flex flex-col gap-1">
            {navItems.map((item) => (
              <NavLink href={item.href} label={item.label} variant="sidebar" />
            ))}
          </nav>
        </div>
      </aside>

      <!-- Overlay (mobile only) -->
      <div
        id="overlay"
        class="fixed inset-0 bg-black/50 hidden z-30 md:hidden"
      ></div>

      <!-- Content -->
      <div class="flex-1 md:ml-64 flex flex-col w-full">

        <!-- Top Bar -->
        <header class="flex items-center justify-between p-4 border-b border-zinc-800 md:hidden">
          <button
            id="menuToggle"
            class="text-zinc-300 hover:text-white"
          >
            â˜°
          </button>
          <span class="font-semibold">Menu</span>
        </header>

        <!-- Page Content -->
        <main class="p-6 md:p-10 max-w-4xl w-full">
          <slot />
        </main>
      </div>
    </div>

    <!-- Minimal JS -->
<script>
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("overlay");
  const toggle = document.getElementById("menuToggle");

  if (sidebar && overlay && toggle) {
    function openSidebar() {
      sidebar.classList.remove("-translate-x-full");
      overlay.classList.remove("hidden");
    }

    function closeSidebar() {
      sidebar.classList.add("-translate-x-full");
      overlay.classList.add("hidden");
    }

    toggle.addEventListener("click", openSidebar);
    overlay.addEventListener("click", closeSidebar);
  }
</script>
  </body>
</html>