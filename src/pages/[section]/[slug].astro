---
import Layout from "../../layouts/Layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const sections = ["health", "imagery", "meTube", "tech"] as const;
  const paths = [];

  for (const section of sections) {
    const entries = await getCollection(section);
    for (const entry of entries) {
      if (!entry.data.draft) {
        paths.push({
          params: {
            section,
            slug: entry.id,
          },
          props: { entry },
        });
      }
    }
  }

  return paths;
}

const { entry } = Astro.props;
const { section } = Astro.params;
const { Content } = await render(entry);
---

<Layout title={entry.data.title}>
  <header class="mb-8">
    <nav class="breadcrumb">
      <a href="/">Home</a> / <span class="capitalize">{section}</span> / {entry.data.title}
    </nav>
    <h1 class="text-3xl font-bold text-white">{entry.data.title}</h1>
  </header>

  <div class="prose prose-lg prose-invert max-w-none prose-img:rounded-xl prose-headings:border-b prose-headings:pb-2 prose-headings:border-zinc-700">
    <Content />
  </div>

  <div class="mt-12 pt-8 border-t border-zinc-700">
    <a href="/" class="back-link">&larr; Back to Home</a>
  </div>
</Layout>
